<?php declare(strict_types=1);
/**
 * modethirteen/miniflex
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
namespace modethirteen\Crypto\Tests\ImportCryptoKeyPairFactory;

use modethirteen\Crypto\Exception\CryptoKeyFactoryCannotConstructCryptoKeyException;
use modethirteen\Crypto\Exception\CryptoKeyCannotParseCryptoKeyTextException;
use modethirteen\Crypto\ImportCryptoKeyPairFactory;
use modethirteen\Crypto\Tests\AbstractCryptoTestCase;

class newCryptoKeyPair_Test extends AbstractCryptoTestCase {

    /**
     * @test
     * @throws CryptoKeyFactoryCannotConstructCryptoKeyException
     * @throws CryptoKeyCannotParseCryptoKeyTextException
     */
    public function Can_get_RSA_key_pair() : void {

        // arrange
        $factory = new ImportCryptoKeyPairFactory(
            self::getRsaPrivateKeyText(),
            self::getRsaPublicKeyText()
        );

        // act
        $pair = $factory->newCryptoKeyPair();

        // assert
        $privateKey = $pair->getPrivateKey();
        static::assertEquals(<<<TEXT
-----BEGIN PRIVATE KEY-----
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
tPlHkivcg04WSgKlb4/QgkGmoji37Q==
-----END PRIVATE KEY-----

TEXT
, $privateKey->toString());
        static::assertEquals(<<<TEXT
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
TEXT
, $privateKey->toText());
        static::assertEquals('PRIVATE KEY', $privateKey->getFormat());
        $publicKey = $pair->getPublicKey();
        static::assertEquals(<<<TEXT
-----BEGIN PUBLIC KEY-----
MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA0qJQSCAO9IF4pPa4r0Kk
+RpYoDaUdCgVqQe9g/sq5w99v8YemyYyIT3hWDoPK/Hk0Afx8iR4RjHza/r+81av
7VO9rIdSeJwOV+ttCfFiz9jkqMp6/ToktpaPXZaBts27mtguwecEklOG12UygzJ6
Rro1peiSfrt2lIhFEQ5Fyyt0f6uFoh9v7JLogLph4epmxoEy3RFA7hWIOJeleNnH
QUVkYZPXCBTjtnvqiTj7BY8lbTGSjaB39S7jwL49UxnJzVmD+hoObjIt/7YPVGg6
2aq/G0JgoLbQc029Oq/EgeyyjkhjWBzz+DT1xPMniUMUVgUZH73avIFW+8S7i+Sb
L4xQOddo0oucEjdQm9gQh7wuvRLQbdEsdQSO1ejCOo/bcWwBaPDwgoS+w7MNLn5V
nIw8O84zUFoBs7ku2ogiro/z1SvdjhPv3sOJozoHlRVzgFQsdHSbXUcTAUpTP2gR
QTZSN7Se/rryeZVZo7FF1nhOB6knkFyVFrgNjReuTqY0MZZq3U6uqZ8wzQqnSVGM
BmY74ynfySU3L+EjYsi6ne1NNoK9wcYjrmyxDcH32CVvj0fSh/pqWY+grrpVe4zS
G68p5SUj8Vz/4vdu7r9io+87hO5fA5Yfratv2Lr53ZiILdPe33chfNkvLXFNbmzW
P0H7G/P8THN5qTFESKWEk/ECAwEAAQ==
-----END PUBLIC KEY-----

TEXT
, $publicKey->toString());
        static::assertEquals(<<<TEXT
MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA0qJQSCAO9IF4pPa4r0Kk+RpYoDaUdCgVqQe9g/sq5w99v8YemyYyIT3hWDoPK/Hk0Afx8iR4RjHza/r+81av7VO9rIdSeJwOV+ttCfFiz9jkqMp6/ToktpaPXZaBts27mtguwecEklOG12UygzJ6Rro1peiSfrt2lIhFEQ5Fyyt0f6uFoh9v7JLogLph4epmxoEy3RFA7hWIOJeleNnHQUVkYZPXCBTjtnvqiTj7BY8lbTGSjaB39S7jwL49UxnJzVmD+hoObjIt/7YPVGg62aq/G0JgoLbQc029Oq/EgeyyjkhjWBzz+DT1xPMniUMUVgUZH73avIFW+8S7i+SbL4xQOddo0oucEjdQm9gQh7wuvRLQbdEsdQSO1ejCOo/bcWwBaPDwgoS+w7MNLn5VnIw8O84zUFoBs7ku2ogiro/z1SvdjhPv3sOJozoHlRVzgFQsdHSbXUcTAUpTP2gRQTZSN7Se/rryeZVZo7FF1nhOB6knkFyVFrgNjReuTqY0MZZq3U6uqZ8wzQqnSVGMBmY74ynfySU3L+EjYsi6ne1NNoK9wcYjrmyxDcH32CVvj0fSh/pqWY+grrpVe4zSG68p5SUj8Vz/4vdu7r9io+87hO5fA5Yfratv2Lr53ZiILdPe33chfNkvLXFNbmzWP0H7G/P8THN5qTFESKWEk/ECAwEAAQ==
TEXT
, $publicKey->toText());
        static::assertEquals('PUBLIC KEY', $publicKey->getFormat());
    }

    /**
     * @test
     * @throws CryptoKeyFactoryCannotConstructCryptoKeyException
     * @throws CryptoKeyCannotParseCryptoKeyTextException
     */
    public function Can_get_PGP_key_pair() : void {

        // arrange
        $factory = new ImportCryptoKeyPairFactory(
            self::getPgpPrivateKeyText(),
            self::getPgpPublicKeyText()
        );

        // act
        $pair = $factory->newCryptoKeyPair();

        // assert
        $privateKey = $pair->getPrivateKey();
        static::assertEquals(<<<TEXT
-----BEGIN PGP PRIVATE KEY BLOCK-----
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
jAiXSg18Kt6n86nWIMcKGGi444MyACNA3Aqj=iBp5
-----END PGP PRIVATE KEY BLOCK-----

TEXT
, $privateKey->toString());
        static::assertEquals(<<<TEXT
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iBp5
TEXT
, $privateKey->toText());
        static::assertEquals('1C63627584B38D8E3DE257C397A625C6D8C7C8F6', $privateKey->getFingerprint());
        static::assertEquals('PGP PRIVATE KEY BLOCK', $privateKey->getFormat());
        $publicKey = $pair->getPublicKey();
        static::assertEquals(<<<TEXT
-----BEGIN PGP PUBLIC KEY BLOCK-----
mQENBF7pY2YBCADNK7wZgyxSbj4hd6uJ3rEk4pSwIxCxDBdi95NTXX8nAh5AuTyb
FNBud+jlmheQy+o0ikIIFJmxz5gbEfXNCzgz6B0zgTnB1x0PIkwEapGUgeofgv+H
JZW6CQQY318oTgYkM9ap9T44ge98ryWTNR14B0aKKyCN9VkjuF7wnxo1ZrXJqHB9
TEdcqRZWVEYlSVc/+9y4Uk0qNtWyJ8+yW09bfMAr4NuOSgFODr24FckBsT7MQsvN
8YWHsO0LILzhi3suEWd1c1zw0iiP4YD0FJ790K5V0cImiZcyr12uE7KNK3TiO7bL
ozGzlHC+ziT16MW2ZaLZ/+7Gh0v00Fnvn+otABEBAAG0DWRla2ktd2ViL3Rlc3SJ
AVQEEwEIAD4WIQQcY2J1hLONjj3iV8OXpiXG2MfI9gUCXuljZgIbAwUJA8IaSgUL
CQgHAgYVCgkICwIEFgIDAQIeAQIXgAAKCRCXpiXG2MfI9nRDB/4xQNsutcwmWMML
8iUUTrSJs6RoH3AUl0qkYcTY+fU2sV+O/lKauMHF39aN2pgUVVo6Ncf9ki6Pp6eU
atb6b1sDCvylpG5pVME0T0CdOozlYZn+/+QSiia4pDLrC7+XEEPzxqZIM59Zk+eC
GoO8RSdBv7CSl9kzscaGibCOyknhWdsGqWmyf8eQm8zY3a7B3PiV1zXMe2RTlz/A
ouWyDfTt48bgrKKxd0rPhWaLFJ65r9Op+vRKaTZYucHu8YcphEyYG6QQ3qXEPD0c
r4OPYSKyMiiBMLW4z1912DW8F61fea+d28c2N6vQqaQRmtz9DLOpy/AWeUPt/N9a
wgJo2QHAuQENBF7pY2YBCACzlOgu8keGPzEEVU0JjXfzRNYXS44ER1HRSNlecb0r
q7e0EIttOVYvsYFbWLmagDRHDsoHn2/44jJczA0l/1OGq1vQmASEE5uKMbIfMIs4
tuHRP6E59JTJZ0Odlm9mB/rdJGA/HXArpoU5UHZycXnobkaq/707cfUgiPv+k7MW
DxGVigbBmupMJYX1rR1et0mBQmmfyM5/KwC3QP6EX6iXloROXgKL9VuNOPq6qWEq
pbROzZNEJ87cTX+oxhE4/kneeoGKYFN0iEZwC2f4JMim6unhuioGYXnlgJu7xWWU
wK1HdcRjZmIrmKLLLMVyrLmdvV/ATjv44RzQZbHSN3WrABEBAAGJATwEGAEIACYW
IQQcY2J1hLONjj3iV8OXpiXG2MfI9gUCXuljZgIbDAUJA8IaSgAKCRCXpiXG2MfI
9mx3CACeV2+EKqkh/KH/Q7eepAnQwfpt8SKNCzaUDfLxkvGWi9imZO7VRvmD/zv8
6PCPXuiwkVkfvS3Ia6u5/zJDozywy8e/g03lOdxxoIC1vF4e49I8xk6m9OuR/hRY
kRlixrF3gcONStsRmFE46u7VA+43NNLpcnu8IrsmmHF4zF0ZCwDLx+CXTPvqbEWe
+HvrUKf2itJ6JS7GwIPR/oWKKBmKSk+Xp7BPom3R3SK0AQYn++qku5BeV/yHy3s+
PswrP0kho9JfMxnq+89xEgNaQGJdUgOWi7bjQx8VxAdvPES5lmAeDAvBjAiXSg18
Kt6n86nWIMcKGGi444MyACNA3Aqj=wRb+
-----END PGP PUBLIC KEY BLOCK-----

TEXT
, $publicKey->toString());
        static::assertEquals(<<<TEXT
mQENBF7pY2YBCADNK7wZgyxSbj4hd6uJ3rEk4pSwIxCxDBdi95NTXX8nAh5AuTybFNBud+jlmheQy+o0ikIIFJmxz5gbEfXNCzgz6B0zgTnB1x0PIkwEapGUgeofgv+HJZW6CQQY318oTgYkM9ap9T44ge98ryWTNR14B0aKKyCN9VkjuF7wnxo1ZrXJqHB9TEdcqRZWVEYlSVc/+9y4Uk0qNtWyJ8+yW09bfMAr4NuOSgFODr24FckBsT7MQsvN8YWHsO0LILzhi3suEWd1c1zw0iiP4YD0FJ790K5V0cImiZcyr12uE7KNK3TiO7bLozGzlHC+ziT16MW2ZaLZ/+7Gh0v00Fnvn+otABEBAAG0DWRla2ktd2ViL3Rlc3SJAVQEEwEIAD4WIQQcY2J1hLONjj3iV8OXpiXG2MfI9gUCXuljZgIbAwUJA8IaSgULCQgHAgYVCgkICwIEFgIDAQIeAQIXgAAKCRCXpiXG2MfI9nRDB/4xQNsutcwmWMML8iUUTrSJs6RoH3AUl0qkYcTY+fU2sV+O/lKauMHF39aN2pgUVVo6Ncf9ki6Pp6eUatb6b1sDCvylpG5pVME0T0CdOozlYZn+/+QSiia4pDLrC7+XEEPzxqZIM59Zk+eCGoO8RSdBv7CSl9kzscaGibCOyknhWdsGqWmyf8eQm8zY3a7B3PiV1zXMe2RTlz/AouWyDfTt48bgrKKxd0rPhWaLFJ65r9Op+vRKaTZYucHu8YcphEyYG6QQ3qXEPD0cr4OPYSKyMiiBMLW4z1912DW8F61fea+d28c2N6vQqaQRmtz9DLOpy/AWeUPt/N9awgJo2QHAuQENBF7pY2YBCACzlOgu8keGPzEEVU0JjXfzRNYXS44ER1HRSNlecb0rq7e0EIttOVYvsYFbWLmagDRHDsoHn2/44jJczA0l/1OGq1vQmASEE5uKMbIfMIs4tuHRP6E59JTJZ0Odlm9mB/rdJGA/HXArpoU5UHZycXnobkaq/707cfUgiPv+k7MWDxGVigbBmupMJYX1rR1et0mBQmmfyM5/KwC3QP6EX6iXloROXgKL9VuNOPq6qWEqpbROzZNEJ87cTX+oxhE4/kneeoGKYFN0iEZwC2f4JMim6unhuioGYXnlgJu7xWWUwK1HdcRjZmIrmKLLLMVyrLmdvV/ATjv44RzQZbHSN3WrABEBAAGJATwEGAEIACYWIQQcY2J1hLONjj3iV8OXpiXG2MfI9gUCXuljZgIbDAUJA8IaSgAKCRCXpiXG2MfI9mx3CACeV2+EKqkh/KH/Q7eepAnQwfpt8SKNCzaUDfLxkvGWi9imZO7VRvmD/zv86PCPXuiwkVkfvS3Ia6u5/zJDozywy8e/g03lOdxxoIC1vF4e49I8xk6m9OuR/hRYkRlixrF3gcONStsRmFE46u7VA+43NNLpcnu8IrsmmHF4zF0ZCwDLx+CXTPvqbEWe+HvrUKf2itJ6JS7GwIPR/oWKKBmKSk+Xp7BPom3R3SK0AQYn++qku5BeV/yHy3s+PswrP0kho9JfMxnq+89xEgNaQGJdUgOWi7bjQx8VxAdvPES5lmAeDAvBjAiXSg18Kt6n86nWIMcKGGi444MyACNA3Aqj=wRb+
TEXT
, $publicKey->toText());
        static::assertEquals('1C63627584B38D8E3DE257C397A625C6D8C7C8F6', $publicKey->getFingerprint());
        static::assertEquals('PGP PUBLIC KEY BLOCK', $publicKey->getFormat());
    }
}
